<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>La Aventura de Nino</title>
<style>
body{
  margin:0;
  background:#1b1235;
  overflow:hidden;
  font-family:monospace;
}

canvas{
  display:block;
  margin:0 auto;
  background:linear-gradient(#2a1f5e,#3c2f7a);
}

#messageBox{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  background:#2c1f55;
  border:4px solid white;
  padding:20px 40px;
  color:white;
  text-align:center;
  display:none;
}

button{
  margin:10px;
  padding:10px 20px;
  font-family:monospace;
  cursor:pointer;
  border:3px solid white;
  background:#ff4da6;
  color:white;
}
button:hover{
  background:#ff78c2;
}
</style>
</head>

<body>

<canvas id="game" width="1000" height="500"></canvas>

<div id="messageBox">
  <h2>ðŸ’– Â¿Quieres ser mi San ValentÃ­n? ðŸ’–</h2>
  <button onclick="yes()">SÃ­ ðŸ’˜</button>
  <button id="noBtn" onmouseover="moveNo()">No ðŸ˜³</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let keys = {};
let gravity = 0.6;
let gameEnded = false;

let player = {
  x:50,
  y:350,
  width:40,
  height:60,
  dy:0,
  jumping:false
};

let obstacles = [];
for(let i=1;i<=5;i++){
  obstacles.push({
    x:300*i,
    y:380,
    width:30,
    height:30
  });
}

let castle = {
  x:1900,
  y:320,
  width:150,
  height:120
};

document.addEventListener("keydown", e=> keys[e.key]=true);
document.addEventListener("keyup", e=> keys[e.key]=false);

function drawBackground(){
  ctx.fillStyle="#24164d";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // suelo
  ctx.fillStyle="#3b2c6d";
  ctx.fillRect(0,420,canvas.width,80);
}

function drawPlayer(){
  ctx.fillStyle="navy";
  ctx.fillRect(player.x,player.y,player.width,player.height);

  // cabello negro
  ctx.fillStyle="black";
  ctx.fillRect(player.x,player.y,player.width,15);

  // nombre
  ctx.fillStyle="white";
  ctx.fillText("NINO",player.x,player.y-10);
}

function drawObstacles(){
  ctx.fillStyle="pink";
  obstacles.forEach(o=>{
    ctx.fillRect(o.x,o.y,o.width,o.height);
  });
}

function drawCastle(){
  ctx.fillStyle="#777";
  ctx.fillRect(castle.x,castle.y,castle.width,castle.height);

  ctx.fillStyle="#555";
  ctx.fillRect(castle.x+40,castle.y+40,70,80);
}

function update(){
  if(gameEnded) return;

  if(keys["ArrowRight"]) player.x+=5;
  if(keys["ArrowLeft"]) player.x-=5;

  if((keys["ArrowUp"] || keys[" "]) && !player.jumping){
    player.dy=-12;
    player.jumping=true;
  }

  player.dy+=gravity;
  player.y+=player.dy;

  if(player.y>350){
    player.y=350;
    player.jumping=false;
  }

  obstacles.forEach(o=>{
    if(player.x<o.x+o.width &&
       player.x+player.width>o.x &&
       player.y<o.y+o.height &&
       player.y+player.height>o.y){
         player.x-=40;
    }
  });

  if(player.x > castle.x){
    endGame();
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawBackground();
  drawCastle();
  drawObstacles();
  drawPlayer();
}

function gameLoop(){
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

function endGame(){
  gameEnded=true;

  ctx.fillStyle="white";
  ctx.fillText("Nino... llegaste hasta aquÃ­.", 350,200);
  ctx.fillText("Manuel te espera...", 400,230);

  // dibujar Manuel
  ctx.fillStyle="white";
  ctx.fillRect(700,350,40,60);

  ctx.fillStyle="black";
  ctx.fillRect(700,350,40,15);

  ctx.fillStyle="black";
  ctx.fillRect(710,370,20,5);

  setTimeout(()=>{
    document.getElementById("messageBox").style.display="block";
  },1500);
}

function yes(){
  document.getElementById("messageBox").innerHTML =
  "<h2>ðŸ’– MisiÃ³n completada ðŸ’–</h2><p>Amor desbloqueado</p>";
}

function moveNo(){
  let btn = document.getElementById("noBtn");
  btn.style.position="absolute";
  btn.style.left=Math.random()*200+"px";
  btn.style.top=Math.random()*200+"px";
}

gameLoop();
</script>

</body>
</html>